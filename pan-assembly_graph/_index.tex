\section{The pan-assembly graph}

The following graph definitions respect the sequence graph definition:

\begin{definition}
  {Sequence graph}{sequence_graph} Let
  \(G = (V_{t}\cup V_{h}, E_{\mathcal{S}} \cup \ELinks{})\) be a multi-undirected
  graph (multigraph) where:

  \begin{itemize}
    \item \(\mathcal{S}\) is the set of sequences

    \item \(\Links{}\) is the multiset of links between oriented sequences

    \item vertices from \(V_{t}\) and \(V_{h}\) represent respectively the tails
      and heads of the sequences

    \item sequence-edges from \(E_{\mathcal{S}}\) represent the sequences and connect
      two extremities of the same sequence (\(E_{\mathcal{S}}\) is a perfect
      matching of the vertices)

    \item link-edges from the multi-link-edge set \(\ELinks{}\) represent
      the links between the sequences
  \end{itemize}
\end{definition}

Let \(Asm_{1}\) and \(Asm_{2}\) be two assembly methods, their respective contig set \(\Contigs{}_{1}\) and \(\Contigs{}_{2}\) and their respective link set \(\Links{}_{1}\) and \(\Links{}_{2}\).
\(G_{1}= (V_{1t}\cup V_{1h}, E_{\Contigs{}_1}\cup E_{\Links{}_1})\) and \(G_{2}= (V_{2t}\cup V_{2h}, E_{\Contigs{}_2}\cup E_{\Links{}_2})\) respectively denote the assembly graphs of \(Asm_{1}\) and \(Asm_{2}\). By \(\Contigs{} = \Contigs{}_1 \cup \Contigs{}_2\) we denote the set of all the contigs.

We denote by the sequence graph \(PG = (V = V_t \cup V_h, E = \EFrags{} \cup \ELinks{})\) the pan-assembly graph, where \(\Fragments{}\) is the set of pangenome fragments.

\input{pan-assembly_graph/contigs}

\input{pan-assembly_graph/fragments}

\input{pan-assembly_graph/links}

\begin{figure}[htb]
  \centering
  \begin{subfigure}[b]{0.45\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pan-assembly_graph/img/panassembly_graph-multi-edges_asm-pan.pdf}
    \caption{Assembly-Pangenome}\label{subfig:panasm_asm-pan}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.45\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pan-assembly_graph/img/panassembly_graph-multi-edges_pan-pan.pdf}
    \caption{Pangenome-Pangenome}\label{subfig:panasm_pan-pan}
  \end{subfigure}
  \figurecaption{Multi-edge examples in the pan-assembly graph.}{%
    Arrows represent (oriented) sequences.
    Heavy ones represent fragments and thin ones represent the contigs.
    \Subref{subfig:panasm_asm-pan}
    Contig \(U\) comes from Unicycler while contigs \(S_1\) and \(S_2\) come from SKESA.
    Fragment set of \(U\) is \( \Fragments(U) = \{b, c, d, f\} \), and these of \(S_1\) and \(S_2\) are respectively \( \Fragments(S_1) = \{a, c\} \) and \( \Fragments(S_2) = \{d, e\} \).
    For example, green link \((c, d) \in \Links{}\) is a pangenome link while grey link \((c, d) \in \Links{}\) is an assembly link.
    \Subref{subfig:panasm_pan-pan}
    Contig \(S\) comes from SKESA, defined by \( \Fragments(S) = \{a, c, d\} \), while contigs \(U_1\) and \(U_2\) come from Unicycler, respectively defined by \( \Fragments(U_1) = \{b, c, d\} \) and \( \Fragments(U_2) = \{d, e\} \).
    Both blue and green multi-links \((c, d)\) are pangenome links, and they respectively connect fragments of contigs \(S\) and \(U_1\).
    However, they enable to connect a subpart of \(U_1\) to contig \(U_2\).
  }\label{fig:panasm_multi-edges}
\end{figure}

\input{pan-assembly_graph/converting_into_simple_graph}